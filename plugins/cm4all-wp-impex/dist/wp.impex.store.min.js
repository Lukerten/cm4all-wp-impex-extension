var wp=wp||{};wp.impex=wp.impex||{};wp.impex.store=(()=>{var m=Object.defineProperty;var P=s=>m(s,"__esModule",{value:!0});var w=(s,a)=>{P(s);for(var n in a)m(s,n,{get:a[n],enumerable:!0})};var I={};w(I,{KEY:()=>f,default:()=>O});var E=window.wp.data;var i=window.wp.apiFetch;var x=window.wp.url;var l=window.wp.impex.debug;var d=l.default("wp.impex.store");d("loaded");var f="cm4all/impex";async function O(s){let{namespace:a,base_uri:n,site_url:_}=s,c={settings:s,imports:[],exports:[],importProfiles:[],exportProfiles:[]},u=await i({path:"/"});if(!u.namespaces.includes(a))throw`rest discovery doesnt provide expected impex rest namespace(=${a})`;if(!u.routes[n])throw`rest discovery doesnt provide expected impex rest route (=${n})`;let T={reducer(r=c,{type:o,payload:e}){switch(o){case"ADD_EXPORT":return{...r,exports:[e,...r.exports]};case"UPDATE_EXPORT":{let t=r.exports.findIndex(p=>p.id===e.id);return t===-1&&d("Export(id=%s) is unknown",e.id),r.exports.splice(t,1,e),{...r,exports:[...r.exports]}}case"DELETE_EXPORT":{let t=r.exports.findIndex(p=>p.id===e);return t===-1&&d("Export(id=%s) is unknown",e),r.exports.splice(t,1),{...r,exports:[...r.exports]}}case"SET_EXPORTS":return{...r,exports:[...e]};case"SET_EXPORTPROFILES":return{...r,exportProfiles:[...e].sort((t,p)=>t.name.localeCompare(p.name))};case"ADD_IMPORT":return{...r,imports:[e,...r.imports]};case"UPDATE_IMPORT":{let t=r.imports.findIndex(p=>p.id===e.id);return t===-1&&d("Export(id=%s) is unknown",e.id),r.imports.splice(t,1,e),{...r,imports:[...r.imports]}}case"DELETE_IMPORT":{let t=r.imports.findIndex(p=>p.id===e);return t===-1&&d("Export(id=%s) is unknown",e),r.imports.splice(t,1),{...r,imports:[...r.imports]}}case"SET_IMPORTS":return{...r,imports:[...e]};case"SET_IMPORTPROFILES":return{...r,importProfiles:[...e].sort((t,p)=>t.name.localeCompare(p.name))}}return r},actions:{async createExport(r,o="",e=""){let t=await i({path:`${s.base_uri}/export`,method:"POST",data:{profile:r.name,name:o,description:e}});return{type:"ADD_EXPORT",payload:t}},setExports(r){return{type:"SET_EXPORTS",payload:r}},async updateExport(r,o){let e=await i({path:`${c.settings.base_uri}/export/${r}`,method:"PATCH",data:o});return{type:"UPDATE_EXPORT",payload:e}},async deleteExport(r){let o=await i({path:`${s.base_uri}/export/${r}`,method:"DELETE"});return{type:"DELETE_EXPORT",payload:r}},async createImport(r,o,e,t){let p=await i({path:`${s.base_uri}/import`,method:"POST",data:{name:r,description:o,profile:e.name,options:t}});return{type:"ADD_IMPORT",payload:p}},async consumeImport(r,o=[],e=null,t=null){let p={};e!==null&&(p.offset=e),t!==null&&(p.limit=t);let S=await i({path:x.addQueryArgs(`${s.base_uri}/import/${r}/consume`,p),method:"POST",data:o});return{type:""}},setImports(r){return{type:"SET_IMPORTS",payload:r}},async updateImport(r,o){let e=await i({path:`${c.settings.base_uri}/import/${r}`,method:"PATCH",data:o});return{type:"UPDATE_IMPORT",payload:e}},async deleteImport(r){let o=await i({path:`${s.base_uri}/import/${r}`,method:"DELETE"});return{type:"DELETE_IMPORT",payload:r}}},selectors:{getExportProfile(r,o){return r.exportProfiles.find(e=>e.name===o)},getExportProfiles(r){return r.exportProfiles},getExport(r,o){return r.exports.find(e=>e.id===o)},getExports(r){return r.exports},getImportProfile(r,o){return r.importProfiles.find(e=>e.name===o)},getImportProfiles(r){return r.importProfiles},getImport(r,o){return r.imports.find(e=>e.id===o)},getImports(r){return r.imports},getSettings(r){return r.settings}},resolvers:{async getExportProfiles(){let r=await i({path:`${n}/export/profile`});return{type:"SET_EXPORTPROFILES",payload:r}},async getExports(){let r=await i({path:`${n}/export`});return{type:"SET_EXPORTS",payload:r}},async getImportProfiles(){let r=await i({path:`${n}/import/profile`});return{type:"SET_IMPORTPROFILES",payload:r}},async getImports(){let r=await i({path:`${n}/import`});return{type:"SET_IMPORTS",payload:r}}}};E.registerStore(f,T)}return I;})();
